jQuery.webshims.register("form-datalist",function(b,f,k,j,l){f.propTypes.element=function(h){f.createPropDefault(h,"attr");if(!h.prop)h.prop={get:function(){var f=h.attr.get.call(this);f&&(f=b("#"+f)[0])&&h.propNodeName&&!b.nodeName(f,h.propNodeName)&&(f=null);return f||null},writeable:!1}};(function(){if(!Modernizr.input.list){var h=0,p={submit:1,button:1,reset:1,hidden:1,range:1,date:1},n=b.browser.msie&&7>parseInt(b.browser.version,10),m={},o=function(a){if(!a)return[];if(m[a])return m[a];var b;
try{b=JSON.parse(localStorage.getItem("storedDatalistOptions"+a))}catch(c){}m[a]=b||[];return b||[]},q={_create:function(a){if(!p[b.prop(a.input,"type")]){var e=a.datalist,c=b.data(a.input,"datalistWidget");if(e&&c&&c.datalist!==e)c.datalist=e,c.id=a.id,c._resetListCached();else if(e){if(!(c&&c.datalist===e)){h++;var d=this;this.hideList=b.proxy(d,"hideList");this.timedHide=function(){clearTimeout(d.hideTimer);d.hideTimer=setTimeout(d.hideList,9)};this.datalist=e;this.id=a.id;this.hasViewableData=
!0;this._autocomplete=b.attr(a.input,"autocomplete");b.data(a.input,"datalistWidget",this);this.shadowList=b('<div class="datalist-polyfill" />').appendTo("body");this.index=-1;this.input=a.input;this.arrayOptions=[];this.shadowList.delegate("li","mouseenter.datalistWidget mousedown.datalistWidget click.datalistWidget",function(a){var c=b("li:not(.hidden-item)",d.shadowList),e="mousedown"==a.type||"click"==a.type;d.markItem(c.index(a.currentTarget),e,c);"click"==a.type&&d.hideList();return"mousedown"!=
a.type}).bind("focusout",this.timedHide);a.input.setAttribute("autocomplete","off");b(a.input).attr({"aria-haspopup":"true"}).bind("input.datalistWidget",function(){if(!d.triggeredByDatalist)d.changedValue=!1,d.showHideOptions()}).bind("keydown.datalistWidget",function(a){var c=a.keyCode;if(40==c&&!d.showList())return d.markItem(d.index+1,!0),!1;if(d.isListVisible){if(38==c)return d.markItem(d.index-1,!0),!1;if(!a.shiftKey&&(33==c||36==c))return d.markItem(0,!0),!1;if(!a.shiftKey&&(34==c||35==c))return a=
b("li:not(.hidden-item)",d.shadowList),d.markItem(a.length-1,!0,a),!1;if(13==c||27==c)return 13==c&&d.changeValue(b("li.active-item:not(.hidden-item)",d.shadowList)),d.hideList(),!1}}).bind("focus.datalistWidget",function(){b(this).hasClass("list-focus")&&d.showList()}).bind("blur.datalistWidget",this.timedHide);b(this.datalist).unbind("updateDatalist.datalistWidget").bind("updateDatalist.datalistWidget",b.proxy(this,"_resetListCached"));this._resetListCached();a.input.form&&a.input.id&&b(a.input.form).bind("submit.datalistWidget"+
a.input.id,function(){var c=b.prop(a.input,"value"),e=(a.input.name||a.input.id)+b.prop(a.input,"type");if(!d.storedOptions)d.storedOptions=o(e);if(c&&-1==d.storedOptions.indexOf(c)&&(d.storedOptions.push(c),c=d.storedOptions,e)){c=c||[];try{localStorage.setItem("storedDatalistOptions"+e,JSON.stringify(c))}catch(f){}}});b(k).bind("unload",function(){d.destroy()})}}else c&&c.destroy()}},destroy:function(){var a=b.attr(this.input,"autocomplete");b(this.input).unbind(".datalistWidget").removeData("datalistWidget");
this.shadowList.remove();b(j).unbind(".datalist"+this.id);this.input.form&&this.input.id&&b(this.input.form).unbind("submit.datalistWidget"+this.input.id);this.input.removeAttribute("aria-haspopup");a===l?this.input.removeAttribute("autocomplete"):b(this.input).attr("autocomplete",a)},_resetListCached:function(a){var b=this,c;this.needsUpdate=!0;this.lastUpdatedValue=!1;this.lastUnfoundValue="";this.updateTimer||(k.QUnit||(c=a&&j.activeElement==b.input)?b.updateListOptions(c):f.ready("WINDOWLOAD",
function(){b.updateTimer=setTimeout(function(){b.updateListOptions();b=null;h=1},200+100*h)}))},updateListOptions:function(a){this.needsUpdate=!1;clearTimeout(this.updateTimer);this.updateTimer=!1;this.shadowList.css({fontSize:b.curCSS(this.input,"fontSize"),fontFamily:b.curCSS(this.input,"fontFamily")});var e=[],c=[],d=[],g,f,i,h;for(f=b.prop(this.datalist,"options"),i=0,h=f.length;i<h;i++){g=f[i];if(g.disabled)return;g={value:b(g).val()||"",text:b.trim(b.attr(g,"label")||g.textContent||g.innerText||
b.text([g])||""),className:g.className||"",style:b.attr(g,"style")||""};g.text?g.text!=g.value&&(g.className+=" different-label-value"):g.text=g.value;c[i]=g.value;d[i]=g}if(!this.storedOptions)this.storedOptions=o((this.input.name||this.input.id)+b.prop(this.input,"type"));this.storedOptions.forEach(function(a){-1==c.indexOf(a)&&d.push({value:a,text:a,className:"stored-suggest",style:""})});for(i=0,h=d.length;i<h;i++)f=d[i],e[i]='<li class="'+f.className+'" style="'+f.style+'" tabindex="-1" role="listitem"><span class="option-label">'+
f.text+'</span> <span class="option-value">'+f.value+"</span></li>";this.arrayOptions=d;this.shadowList.html('<ul role="list" class="'+(this.datalist.className||"")+" "+this.datalist.id+'-shadowdom">'+e.join("\n")+"</ul>");b.fn.bgIframe&&n&&this.shadowList.bgIframe();(a||this.isListVisible)&&this.showHideOptions()},showHideOptions:function(){var a=b.prop(this.input,"value").toLowerCase();if(!(a===this.lastUpdatedValue||this.lastUnfoundValue&&0===a.indexOf(this.lastUnfoundValue))){this.lastUpdatedValue=
a;var e=!1,c=b("li",this.shadowList);a?this.arrayOptions.forEach(function(d,f){if(!("lowerText"in d))d.lowerText=d.text!=d.value?d.text.toLowerCase()+d.value.toLowerCase():d.text.toLowerCase();-1!==d.lowerText.indexOf(a)?(b(c[f]).removeClass("hidden-item"),e=!0):b(c[f]).addClass("hidden-item")}):c.length&&(c.removeClass("hidden-item"),e=!0);(this.hasViewableData=e)?this.showList():(this.lastUnfoundValue=a,this.hideList())}},getPos:function(){var a=b(this.input).offset();a.top+=b(this.input).outerHeight();
a.width=b(this.input).outerWidth()-(parseInt(this.shadowList.css("borderLeftWidth"),10)||0)-(parseInt(this.shadowList.css("borderRightWidth"),10)||0);return a},showList:function(){if(this.isListVisible)return!1;this.needsUpdate&&this.updateListOptions();this.showHideOptions();if(!this.hasViewableData)return!1;var a=this,e,c=a.getPos();n&&(a.shadowList.css("height","auto"),250<a.shadowList.height()&&a.shadowList.css("height",220));a.shadowList.css(c).addClass("datalist-visible");a.isListVisible=!0;
b(j).unbind(".datalist"+a.id).bind("mousedown.datalist"+a.id+" focusin.datalist"+a.id,function(c){c.target===a.input||a.shadowList[0]===c.target||b.contains(a.shadowList[0],c.target)?(clearTimeout(a.hideTimer),setTimeout(function(){clearTimeout(a.hideTimer)},9)):a.timedHide()});b(k).unbind(".datalist"+a.id).bind("resize.datalist"+a.id,function(){clearTimeout(e);e=setTimeout(function(){a.shadowList.css(a.getPos())},9)});return!0},hideList:function(){if(!this.isListVisible)return!1;var a=this,e=function(){a.changedValue&&
b(a.input).trigger("change");a.changedValue=!1};a.shadowList.removeClass("datalist-visible list-item-active").scrollTop(0).find("li.active-item").removeClass("active-item");a.index=-1;a.isListVisible=!1;if(a.changedValue){a.triggeredByDatalist=!0;f.triggerInlineForm&&f.triggerInlineForm(a.input,"input");if(a.input==j.activeElement||b(a.input).is(":focus"))b(a.input).one("blur",e);else e();a.triggeredByDatalist=!1}b(j).unbind(".datalist"+a.id);b(k).unbind(".datalist"+a.id);return!0},scrollIntoView:function(a){var e=
b("> ul",this.shadowList),c=a.position();c.top-=(parseInt(e.css("paddingTop"),10)||0)+(parseInt(e.css("marginTop"),10)||0)+(parseInt(e.css("borderTopWidth"),10)||0);0>c.top?this.shadowList.scrollTop(this.shadowList.scrollTop()+c.top-2):(c.top+=a.outerHeight(),a=this.shadowList.height(),c.top>a&&this.shadowList.scrollTop(this.shadowList.scrollTop()+(c.top-a)+2))},changeValue:function(a){if(a[0]){var a=b("span.option-value",a).text(),e=b.prop(this.input,"value");if(a!=e)b(this.input).prop("value",a).triggerHandler("updateInput"),
this.changedValue=!0}},markItem:function(a,e,c){c=c||b("li:not(.hidden-item)",this.shadowList);if(c.length)0>a?a=c.length-1:a>=c.length&&(a=0),c.removeClass("active-item"),this.shadowList.addClass("list-item-active"),c=c.filter(":eq("+a+")").addClass("active-item"),e&&(this.changeValue(c),this.scrollIntoView(c)),this.index=a}};(function(){f.defineNodeNameProperty("datalist","options",{prop:{writeable:!1,get:function(){var a=b("select",this);return a[0]?a[0].options:[]}}});f.defineNodeNameProperties("input",
{selectedOption:{prop:{writeable:!1,get:function(){var a=b.prop(this,"list"),e=null,c;if(!a)return e;c=b.attr(this,"value");if(!c)return e;a=b.prop(a,"options");if(!a.length)return e;b.each(a,function(a,f){if(c==b.prop(f,"value"))return e=f,!1});return e}}},autocomplete:{attr:{get:function(){var a=b.data(this,"datalistWidget");return a?a._autocomplete:"autocomplete"in this?this.autocomplete:this.getAttribute("autocomplete")},set:function(a){var e=b.data(this,"datalistWidget");e?(e._autocomplete=a,
"off"==a&&e.hideList()):"autocomplete"in this?this.autocomplete=a:this.setAttribute("autocomplete",a)}}},list:{attr:{get:function(){var a=f.contentAttr(this,"list");return null==a?l:a},set:function(a){f.contentAttr(this,"list",a);f.objectCreate(q,l,{input:this,id:a,datalist:b.prop(this,"list")})}},initAttr:!0,reflect:!0,propType:"element",propNodeName:"datalist"}});if(b.event.customEvent)b.event.customEvent.updateDatalist=!0,b.event.customEvent.updateInput=!0;f.addReady(function(a,e){e.filter("select, option").each(function(){var a=
this.parentNode,d=b.nodeName(a,"datalist");if(a&&!d)a=a.parentNode,d=b.nodeName(a,"datalist");a&&d&&b(a).triggerHandler("updateDatalist")})})})()}})()});
